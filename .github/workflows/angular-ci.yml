deploy-azure-static-web-app:
  runs-on: ubuntu-latest
  needs: build-test-coverage
  if: github.ref == 'refs/heads/master'
  steps:
    - uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 20

    - name: Install dependencies
      run: npm ci

    - name: Build Angular app
      run: npm run build --prod

    - name: Deploy to Azure Static Web App
      uses: Azure/static-web-apps-deploy@v1
      with:
        azure_static_web_apps_api_token: ${{ secrets.AZURE_STATIC_WEB_APPS_API_TOKEN }}
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        action: "upload"
        app_location: "/" # raiz do projeto
        output_location: "dist/freela-match-web" # pasta gerada pelo build do Angular
